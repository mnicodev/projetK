<?php

/**
 * @file
 * Contains kidiklik_front.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_help().
 */
function kidiklik_front_help($route_name, RouteMatchInterface $route_match) {
  switch ($route_name) {
    // Main module help for the kidiklik_front module.
    case 'help.page.kidiklik_front':
      $output = '';
      $output .= '<h3>' . t('About') . '</h3>';
      $output .= '<p>' . t('Module pour la gestion du front') . '</p>';
      return $output;

    default:
  }
}

/**
 * Implements hook_theme().
 */
function kidiklik_front_theme() {
  return [
    'kidiklik_front' => [
      'render element' => 'children',
    ],
  ];
}


/*
 * Modification de la requête sql d'une vue
 */
function kidiklik_front_views_query_alter(Drupal\views\ViewExecutable $view, Drupal\views\Plugin\views\query\Sql $query) {
	$term_dep=get_term_departement();
	
	if($view->current_display=="diaporama") {
		/* la date de début du bloc de mise en avant doit être inférieur ou égal à la date du jour */ 
		$query->where[1]["conditions"][2]["value"]=date("Y-m-d");
		$query->where[1]["conditions"][2]["operator"]="<=";
		/* la date de fin du bloc de mise en avant doit être supérieur ou égal à la date du jour */
		$query->where[1]["conditions"][3]["value"]=date("Y-m-d");
		$query->where[1]["conditions"][3]["operator"]=">=";
		//kint($query->where);
		
	}
	
	if($view->current_display=="recherche_activites") {

	}
}